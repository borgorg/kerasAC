# kerasAC
keras accessibility models for genomic data 

## dependencies ## 
* pysam
* tiledb>=0.5.2
* psutil
* tables
* numpy>=1.9
* keras>=2.2
* h5py
* pandas
* pybigwig (I had had errors with the pip version, recommend bioconda:https://anaconda.org/bioconda/pybigwig)
* deeplift
* abstention
* boto3

## Installation ##

To install the module:

`pip install -e kerasAC`

## Model Inputs ##

kerasAC takes tiledb and hdf5 inputs generated by seqdataloader(https://github.com/kundajelab/seqdataloader)

profile models can be trained on tiledb databases generated by https://github.com/kundajelab/seqdataloader#dbingest

binned models can be trained from outputs generated by https://github.com/kundajelab/seqdataloader#labelgen or from outputs generated by https://github.com/kundajelab/seqdataloader#dbingest

See examples in seqdataloader repo (https://github.com/kundajelab/seqdataloader/tree/master/examples) for examples of input generation.  

The documentation below is provided in reference to a canonical cell line DNAse tiledb dataset, generated by this script: https://github.com/kundajelab/seqdataloader/blob/master/examples/dbingest/run_db_ingest.sh

## Commands ##
kerasAC provides the following commands:


* kerasAC_loss_weights -- find the count and profile loss weights for a bpnet model from an input data set.
See example: 
* kerasAC_train -- train a neural network


To train a model: **kerasAC_train**

To predict on a test dataset: **kerasAC_predict**

To interpret a model: **kerasAC_interpret**

To run n-fold cross validation for training/ prediction / interpretation: **kerasAC_cross_validate** 

see "examples" folder for example parameters to use with each of these functionalities
